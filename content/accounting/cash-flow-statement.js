import React from 'react';
import VisualAid from '../../components/VisualAid';
import FormulaDisplay from '../../components/FormulaDisplay';
import ComparisonTable from '../../components/ComparisonTable';
import ProcessFlow from '../../components/ProcessFlow';
import ChartDisplay from '../../components/ChartDisplay';
import KeyConcept from '../../components/KeyConcept';
import CaseStudy from '../../components/CaseStudy';
import PracticeQuestion from '../../components/PracticeQuestion';

const cashFlowStatementContent = () => {
  return (
    <div className="content-container">
      <KeyConcept
        title="Navigating the Cash Flow Statement"
        concept="The Cash Flow Statement tracks the movement of cash both into and out of a company over a period of time, providing insight into a company's liquidity and solvency that may not be apparent from the income statement alone."
        explanation="The Cash Flow Statement is crucial because net income, as reported on the income statement, doesn't always reflect the actual cash generated by a company. It is divided into three main sections: cash flow from operating activities (day-to-day business operations), cash flow from investing activities (purchase and sale of long-term assets), and cash flow from financing activities (debt, equity, and dividends). The bottom line shows the net change in cash during the period, which equals the difference between the beginning and ending cash balances on the balance sheet."
        importance="The cash flow statement is often considered the most important financial statement by many investors and analysts because 'cash is king.' It reveals a company's ability to generate cash to fund operations, investments, and debt obligations. In investment banking, understanding cash flow is critical for assessing a company's ability to service debt (important for LBOs), valuing a business (DCF analysis uses projected free cash flows), and identifying potential liquidity issues that might not be apparent from the income statement alone. When building an LBO model, you'll project a company's future cash flows to determine its debt repayment capacity. For DCF valuation, you'll derive and discount projected free cash flows. When advising on capital structure, you'll assess a company's cash generation to recommend sustainable debt levels."
        examples={[
          "A company with positive net income but negative operating cash flow due to increasing accounts receivable",
          "A company with negative net income but positive operating cash flow due to non-cash expenses like depreciation",
          "A company with strong operating cash flow but negative free cash flow due to heavy capital expenditures",
          "A company using financing cash flow to fund a dividend despite weak operating cash flow"
        ]}
      />
      
      <VisualAid title="Cash Flow Statement Structure" type="concept">
        <div className="cash-flow-structure">
          <div className="structure-item mb-4">
            <h4>1. Cash Flow from Operating Activities</h4>
            <p>Cash generated from the normal day-to-day business operations.</p>
            <ul>
              <li><strong>Direct Method:</strong> Shows operating cash receipts and payments (rarely used)</li>
              <li><strong>Indirect Method:</strong> Starts with net income and adjusts for non-cash items and changes in working capital (most common)</li>
              <li>Key adjustments include:</li>
              <ul>
                <li>Adding back non-cash expenses (depreciation, amortization)</li>
                <li>Adjusting for non-operating gains/losses</li>
                <li>Accounting for changes in working capital accounts</li>
              </ul>
              <li>Positive operating cash flow indicates the company can generate sufficient cash from its core business</li>
            </ul>
          </div>
          
          <div className="structure-item mb-4">
            <h4>2. Cash Flow from Investing Activities</h4>
            <p>Cash flow related to the purchase and sale of long-term assets.</p>
            <ul>
              <li>Capital expenditures (CapEx) - purchase of property, plant, and equipment</li>
              <li>Acquisitions of other businesses</li>
              <li>Purchases or sales of investment securities</li>
              <li>Typically negative for growing companies due to investments in long-term assets</li>
              <li>Consistently positive investing cash flow might indicate asset sales or underinvestment</li>
            </ul>
          </div>
          
          <div className="structure-item mb-4">
            <h4>3. Cash Flow from Financing Activities</h4>
            <p>Cash flow related to debt, equity, and dividends.</p>
            <ul>
              <li>Debt issuance or repayment</li>
              <li>Equity issuance or share repurchases</li>
              <li>Dividend payments</li>
              <li>Positive financing cash flow indicates the company is raising capital</li>
              <li>Negative financing cash flow indicates the company is returning capital to investors or paying down debt</li>
            </ul>
          </div>
          
          <div className="structure-item">
            <h4>4. Net Change in Cash</h4>
            <p>The sum of all three sections, showing the overall increase or decrease in cash.</p>
            <ul>
              <li>Net Change in Cash = Cash from Operations + Cash from Investing + Cash from Financing</li>
              <li>This amount reconciles the beginning and ending cash balances on the balance sheet</li>
              <li>A company can have negative cash flow in one or two sections but still have positive overall cash flow</li>
              <li>Sustainable business models typically generate positive operating cash flow over time</li>
            </ul>
          </div>
        </div>
      </VisualAid>
      
      <FormulaDisplay
        title="Cash Flow from Operations (Indirect Method)"
        formula="CFO = Net Income + Non-cash Expenses - Non-cash Income ± Changes in Working Capital"
        variables={[
          { symbol: "CFO", description: "Cash Flow from Operations" },
          { symbol: "Net Income", description: "Profit after tax from the Income Statement" },
          { symbol: "Non-cash Expenses", description: "Expenses that don't involve cash outflow (e.g., depreciation, amortization)" },
          { symbol: "Non-cash Income", description: "Income that doesn't involve cash inflow (e.g., unrealized gains)" },
          { symbol: "Changes in Working Capital", description: "Net changes in current operating assets and liabilities" }
        ]}
        example="A company reports net income of $100M, depreciation of $20M, an increase in accounts receivable of $15M, and a decrease in inventory of $10M. Cash flow from operations = $100M + $20M - $15M + $10M = $115M."
        notes="Working capital adjustments follow this pattern: Increase in operating assets (e.g., accounts receivable, inventory) reduces cash flow; Decrease in operating assets increases cash flow; Increase in operating liabilities (e.g., accounts payable) increases cash flow; Decrease in operating liabilities reduces cash flow."
      />
      
      <FormulaDisplay
        title="Free Cash Flow Calculation"
        formula="FCF = Cash Flow from Operations - Capital Expenditures"
        variables={[
          { symbol: "FCF", description: "Free Cash Flow" },
          { symbol: "Cash Flow from Operations", description: "Net cash generated from operating activities" },
          { symbol: "Capital Expenditures", description: "Cash spent on purchasing or improving long-term assets" }
        ]}
        example="If a company has $200M in operating cash flow and spends $150M on capital expenditures, its free cash flow would be: $200M - $150M = $50M."
        notes="Free Cash Flow represents the cash a company generates after accounting for cash outflows to support operations and maintain capital assets. It's the cash available to repay creditors or pay dividends and is a key input in DCF valuation models. Some analysts use variations like 'Free Cash Flow to Firm' (FCFF) or 'Free Cash Flow to Equity' (FCFE) depending on the specific valuation context."
      />
      
      <ComparisonTable
        title="Cash Flow Metrics Comparison"
        headers={["Metric", "Formula", "What It Measures", "Significance in Banking"]}
        rows={[
          [
            "Operating Cash Flow (OCF)",
            "Net Income + Non-cash Items ± Working Capital Changes",
            "Cash generated from core business operations",
            "Indicates whether a company can generate sufficient cash from its core business; Essential for assessing operational health; Used to evaluate debt service capacity"
          ],
          [
            "Free Cash Flow (FCF)",
            "OCF - Capital Expenditures",
            "Cash available after maintaining and growing operations",
            "Key input for DCF valuation models; Indicates cash available for debt repayment, dividends, or acquisitions; Used to assess financial flexibility"
          ],
          [
            "Free Cash Flow to Firm (FCFF)",
            "EBIT(1-Tax Rate) + Depreciation - CapEx - ΔWorking Capital",
            "Cash available to all capital providers (debt and equity)",
            "Used for enterprise valuation; Represents pre-debt cash flow; Standard metric for DCF models in investment banking"
          ],
          [
            "Free Cash Flow to Equity (FCFE)",
            "FCFF - Interest(1-Tax Rate) + Net Borrowing",
            "Cash available to equity holders only",
            "Used for equity valuation; Represents post-debt cash flow; Important for assessing dividend capacity"
          ],
          [
            "Cash Flow Coverage Ratio",
            "OCF / Total Debt Service",
            "Ability to meet debt obligations with operating cash flow",
            "Critical for debt capacity analysis; Used in credit assessments; Key metric in LBO analysis"
          ]
        ]}
        description="These cash flow metrics serve different purposes in financial analysis and are used in various contexts in investment banking. Understanding the distinctions between them is crucial for appropriate application in valuation, credit analysis, and strategic advisory."
      />
      
      <ProcessFlow
        title="Cash Flow Analysis Process"
        steps={[
          {
            title: "Review Historical Cash Flow Statements",
            description: "Analyze past cash flow patterns to understand the company's cash generation profile.",
            details: "Examine at least 3-5 years of historical cash flow statements. Identify trends in operating, investing, and financing cash flows. Calculate key cash flow ratios and metrics. Note any unusual or one-time items that affected cash flow."
          },
          {
            title: "Assess Cash Flow Quality",
            description: "Evaluate the sustainability and reliability of the company's cash flows.",
            details: "Compare operating cash flow to net income (cash conversion). Analyze the components driving operating cash flow. Identify recurring versus non-recurring cash flows. Evaluate working capital management efficiency."
          },
          {
            title: "Analyze Capital Expenditure Patterns",
            description: "Understand the company's investment in long-term assets.",
            details: "Compare CapEx to depreciation (maintenance vs. growth CapEx). Assess the relationship between CapEx and revenue growth. Evaluate the return on invested capital from past investments. Consider industry benchmarks for capital intensity."
          },
          {
            title: "Evaluate Financing Activities",
            description: "Analyze how the company is managing its capital structure.",
            details: "Review debt issuance and repayment patterns. Assess dividend policy and share repurchase programs. Evaluate the company's access to capital markets. Consider the impact of financing decisions on financial flexibility."
          },
          {
            title: "Project Future Cash Flows",
            description: "Forecast expected cash flows based on historical patterns and future plans.",
            details: "Develop operating cash flow projections based on revenue and margin forecasts. Estimate future capital expenditure requirements. Project working capital needs based on growth expectations. Model expected financing activities and capital returns."
          },
          {
            title: "Perform Sensitivity Analysis",
            description: "Test how changes in key assumptions affect projected cash flows.",
            details: "Vary revenue growth, profit margins, and working capital assumptions. Adjust capital expenditure projections. Consider different scenarios for interest rates and financing costs. Assess the impact of potential strategic initiatives or market changes."
          },
          {
            title: "Draw Conclusions and Make Recommendations",
            description: "Synthesize findings into actionable insights.",
            details: "Assess the company's cash flow generation capacity. Evaluate financial flexibility and liquidity position. Determine appropriate capital structure based on cash flow stability. Recommend strategic initiatives to improve cash flow performance."
          }
        ]}
        description="This systematic approach to cash flow analysis provides a comprehensive understanding of a company's cash generation capacity, investment needs, and financial flexibility, which is essential for valuation, capital structure advisory, and strategic decision-making in investment banking."
      />
      
      <ChartDisplay
        title="Cash Flow Waterfall"
        chartType="bar"
        imageUrl="/images/cash-flow-waterfall.png"
        description="A cash flow waterfall chart visually represents how a company moves from net income to cash flow from operations by showing the impact of various adjustments. This example illustrates how non-cash expenses, gains/losses, and working capital changes affect the transformation of accounting profit into actual cash generated."
      />
      
      <CaseStudy
        title="Cash Flow Analysis: Tech Manufacturing Company"
        scenario="You're an investment banking analyst working on a potential LBO for TechManufacture Inc., a mid-sized electronics components manufacturer. The company has shown strong revenue growth (15% annually) and stable EBITDA margins (22%) over the past three years. However, the private equity client is concerned about the company's cash flow conversion. The company reported $120M in net income last year but only $80M in operating cash flow and $30M in free cash flow."
        questions={[
          "What might explain the gap between net income and operating cash flow?",
          "Why is free cash flow significantly lower than operating cash flow?",
          "What additional information would you need to assess the company's cash flow quality?",
          "How would these cash flow patterns affect the company's ability to support leverage in an LBO?"
        ]}
        analysis={
          <div>
            <p><strong>Gap between Net Income and Operating Cash Flow:</strong></p>
            <p>The $40M difference between net income ($120M) and operating cash flow ($80M) suggests working capital inefficiencies. Possible explanations include:</p>
            <ul>
              <li>Increasing accounts receivable due to extended customer payment terms or collection issues</li>
              <li>Growing inventory levels that might indicate production inefficiencies or slowing sales</li>
              <li>Decreasing accounts payable, possibly from paying suppliers more quickly</li>
            </ul>
            
            <p><strong>Low Free Cash Flow:</strong></p>
            <p>The $50M difference between operating cash flow ($80M) and free cash flow ($30M) indicates high capital expenditures. For a manufacturing company, this could represent:</p>
            <ul>
              <li>Significant investment in new production facilities or equipment upgrades</li>
              <li>Expansion into new product lines requiring new manufacturing capabilities</li>
              <li>Replacement of aging equipment (maintenance CapEx)</li>
            </ul>
            
            <p><strong>Additional Information Needed:</strong></p>
            <ul>
              <li>Detailed breakdown of working capital changes</li>
              <li>Historical CapEx spending and future CapEx plans</li>
              <li>Breakdown of maintenance vs. growth CapEx</li>
              <li>Industry benchmarks for cash conversion</li>
              <li>Management's strategy for improving working capital efficiency</li>
              <li>Expected completion timeline for major capital projects</li>
            </ul>
          </div>
        }
        conclusion="Based on the analysis, TechManufacture Inc. presents both opportunities and challenges for an LBO. The strong revenue growth and stable EBITDA margins are positive indicators, but the cash flow conversion issues need to be addressed. The high CapEx relative to operating cash flow suggests significant investment in growth, which could potentially be moderated post-acquisition to improve free cash flow. The working capital inefficiencies represent an opportunity for operational improvement that could release trapped cash."
        takeaways={[
          "Cash flow analysis provides insights that aren't apparent from the income statement alone",
          "Working capital management is critical for converting EBITDA to cash flow",
          "Understanding the nature of capital expenditures (maintenance vs. growth) is essential for projecting sustainable free cash flow",
          "In LBO scenarios, companies with temporarily depressed free cash flow due to growth investments may present opportunities if those investments can be optimized",
          "Cash flow conversion metrics are as important as growth and margin metrics when evaluating LBO candidates"
        ]}
      />
      
      <PracticeQuestion
        question={{
          question: "A company reports the following financial information: Net Income: $50M, Depreciation: $15M, Increase in Accounts Receivable: $8M, Decrease in Inventory: $5M, Decrease in Accounts Payable: $7M, Capital Expenditures: $30M. Calculate the company's Operating Cash Flow and Free Cash Flow.",
          solution: "Step 1: Calculate Operating Cash Flow using the indirect method\nOperating Cash Flow = Net Income + Depreciation - Increase in A/R + Decrease in Inventory - Decrease in A/P\nOperating Cash Flow = $50M + $15M - $8M + $5M - $7M = $55M\n\nStep 2: Calculate Free Cash Flow\nFree Cash Flow = Operating Cash Flow - Capital Expenditures\nFree Cash Flow = $55M - $30M = $25M",
          explanation: "The indirect method for calculating operating cash flow starts with net income and makes adjustments for non-cash items and changes in working capital. Depreciation is added back because it's a non-cash expense. Changes in working capital are adjusted according to their impact on cash: increases in operating assets (like A/R) reduce cash, decreases in operating assets (like inventory) increase cash, increases in operating liabilities increase cash, and decreases in operating liabilities (like A/P) reduce cash. Free cash flow is then calculated by subtracting capital expenditures from operating cash flow.",
          keyTakeaways: [
            "Operating cash flow adjusts net income for non-cash items and working capital changes",
            "Working capital changes affect cash flow in specific ways: increases in assets and decreases in liabilities reduce cash",
            "Free cash flow represents the cash available after maintaining and growing operations",
            "The difference between operating cash flow and free cash flow indicates the level of capital investment"
          ]
        }}
        difficulty="medium"
      />
      
      <PracticeQuestion
        question={{
          question: "Company A has consistently reported growing net income over the past five years but has experienced negative operating cash flow in the same period. As an investment banking analyst, what might explain this discrepancy, and what concerns would you raise about this company?",
          hint: "Think about the relationship between accrual accounting and cash flow, and consider the components of the indirect cash flow calculation.",
          solution: "Several factors could explain the discrepancy between growing net income and negative operating cash flow:\n\n1. Aggressive Revenue Recognition: The company might be recognizing revenue before cash is collected, inflating net income while actual cash collection lags.\n\n2. Working Capital Inefficiencies: Rapid growth often requires investment in working capital. The company might be experiencing:\n   - Rapidly increasing accounts receivable due to extended customer payment terms\n   - Growing inventory levels to support sales growth\n   - Decreasing accounts payable by paying suppliers more quickly\n\n3. Non-cash Income: The company might be recording significant non-cash gains that boost net income but don't generate cash.\n\n4. Deferred Expenses: The company might be capitalizing costs that should be expensed, artificially inflating current profitability.\n\nConcerns to raise:\n\n1. Sustainability: The business model may not be sustainable if it cannot convert accounting profits to cash.\n\n2. Liquidity Risk: Continued negative operating cash flow could lead to liquidity problems and potential default.\n\n3. Accounting Quality: The discrepancy raises questions about the quality of earnings and potential aggressive accounting practices.\n\n4. Financing Needs: The company likely requires continuous external financing to fund operations, creating dependency on capital markets.\n\n5. Valuation Impact: Companies with poor cash conversion typically warrant lower valuation multiples.",
          explanation: "This question tests your understanding of the relationship between accrual accounting (which determines net income) and cash accounting (which determines cash flow). The persistent gap between these metrics suggests structural issues in the business model or potential accounting concerns. In investment banking, identifying such discrepancies is crucial when advising on M&A transactions or capital raising, as they may significantly impact valuation and deal structure.",
          keyTakeaways: [
            "Net income and operating cash flow can diverge significantly due to accrual accounting principles",
            "Persistent negative operating cash flow despite positive net income is a red flag",
            "Working capital management is critical for growing companies to avoid cash flow problems",
            "Cash flow analysis provides insights into the quality of earnings and sustainability of the business model",
            "Companies with poor cash conversion typically warrant more conservative valuations in banking analyses"
          ]
        }}
        difficulty="hard"
      />
    </div>
  );
};

export default cashFlowStatementContent;
